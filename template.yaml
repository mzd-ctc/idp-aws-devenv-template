apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: terraform-aws-environment
  namespace: default
  title: AWS Terraform í™˜ê²½ ìƒì„±
  description: AWS í´ë¼ìš°ë“œë¥¼ ìœ„í•œ íŒ€/í™˜ê²½ë³„ IaC í…œí”Œë¦¿ ìë™í™” ë° GitHub ì €ì¥
  annotations:
    github.com/project-slug: mzd-ctc/idp-aws-devenv-template
    backstage.io/source-location: url:https://github.com/mzd-ctc/idp-aws-devenv-template
  tags:
    - terraform
    - aws
    - infrastructure
    - devops
spec:
  owner: platform-team
  type: infrastructure
  parameters:
    - title: ğŸ¢ ê¸°ë³¸ ì •ë³´
      required: [team_name, environment_type, project_name]
      properties:
        team_name:
          title: íŒ€ ì´ë¦„
          type: string
          description: íŒ€ ë˜ëŠ” ì¡°ì§ ì´ë¦„ (ì˜ˆ backend-team, frontend-team)
          pattern: '^[a-z0-9-]+$'
          ui:help: ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥
        environment_type:
          title: í™˜ê²½ íƒ€ì…
          type: string
          enum: [dev, stg, prod]
          enumNames: ['ê°œë°œ (Development)', 'ìŠ¤í…Œì´ì§• (Staging)', 'ìš´ì˜ (Production)']
          description: ë°°í¬í•  í™˜ê²½ íƒ€ì…
          default: dev
        project_name:
          title: í”„ë¡œì íŠ¸ëª…
          type: string
          description: í”„ë¡œì íŠ¸ ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„ (ì˜ˆ ecommerce-api, user-portal)
          pattern: '^[a-z0-9-]+$'
          ui:help: ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥
        aws_region:
          title: AWS ë¦¬ì „
          type: string
          enum: 
            - ap-northeast-2
            - ap-northeast-1
            - us-east-1
            - us-west-2
            - eu-west-1
          enumNames:
            - 'ì„œìš¸ (ap-northeast-2)'
            - 'ë„ì¿„ (ap-northeast-1)'
            - 'N. Virginia (us-east-1)'
            - 'Oregon (us-west-2)'
            - 'Ireland (eu-west-1)'
          default: ap-northeast-2
          description: AWS ë¦¬ì „ ì„ íƒ

    - title: ğŸ“‚ GitHub ì„¤ì •
      required: [github_token, github_owner, github_repo]
      properties:
        github_token:
          title: GitHub Personal Access Token
          type: string
          description: GitHub API ì ‘ê·¼ì„ ìœ„í•œ Personal Access Token (ghp_ë¡œ ì‹œì‘)
          #ui:widget: password
          ui:help: repo, workflow ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤
        github_owner:
          title: GitHub ì†Œìœ ì
          type: string
          description: GitHub ì¡°ì§ ë˜ëŠ” ì‚¬ìš©ìëª…
          default: mzd-ctc
          pattern: '^[a-zA-Z0-9-]+$'
        github_repo:
          title: GitHub ë ˆí¬ì§€í† ë¦¬ëª…
          type: string
          description: ìƒì„±í•  ë ˆí¬ì§€í† ë¦¬ëª… (ì˜ˆ project-env-infrastructure)
          pattern: '^[a-zA-Z0-9-_.]+$'
        github_branch:
          title: ë¸Œëœì¹˜ëª…
          type: string
          default: main
          description: ê¸°ë³¸ ë¸Œëœì¹˜ëª…

    - title: ğŸ” AWS ì¸ì¦ ì •ë³´
      description: AWS ë¦¬ì†ŒìŠ¤ ìƒì„±ì„ ìœ„í•œ ì¸ì¦ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”
      required: [aws_access_key_id, aws_secret_access_key]
      properties:
        aws_access_key_id:
          title: AWS Access Key ID
          type: string
          description: AWS Access Key ID (GitHub Secretsì— ì €ì¥ë©ë‹ˆë‹¤)
          ui:widget: password
        aws_secret_access_key:
          title: AWS Secret Access Key
          type: string
          description: AWS Secret Access Key (GitHub Secretsì— ì €ì¥ë©ë‹ˆë‹¤)
          ui:widget: password

    - title: âš™ï¸ GitHub Actions ì„¤ì •
      description: GitHub Actions ì„¤ì •ì€ ìƒì„±ëœ ë ˆí¬ì§€í† ë¦¬ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ êµ¬ì„±í•˜ì„¸ìš”

    - title: ğŸ—ï¸ ì¸í”„ë¼ ì„¤ì •
      description: ìƒì„±í•  ì¸í”„ë¼ ì»´í¬ë„ŒíŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”
      properties:
        skeleton_source:
          title: ìŠ¤ì¼ˆë ˆí†¤ ì†ŒìŠ¤
          type: string
          enum: [local, github]
          enumNames: ['ë¡œì»¬ íŒŒì¼ (í…ŒìŠ¤íŠ¸ìš©)', 'GitHub í…œí”Œë¦¿ (í…œí”Œë¦¿ìš©)']
          default: local
          description: ìŠ¤ì¼ˆë ˆí†¤ íŒŒì¼ì˜ ì†ŒìŠ¤ë¥¼ ì„ íƒí•˜ì„¸ìš”
        github_template_owner:
          title: GitHub í…œí”Œë¦¿ ì†Œìœ ì
          type: string
          description: GitHub í…œí”Œë¦¿ ë ˆí¬ì§€í† ë¦¬ ì†Œìœ ì (ì¡°ì§ ë˜ëŠ” ì‚¬ìš©ìëª…)
          default: mzd-ctc
          pattern: '^[a-zA-Z0-9-]+$'
          ui:
            help: skeleton_sourceê°€ githubì¼ ë•Œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤
        github_template_repo:
          title: GitHub í…œí”Œë¦¿ ë ˆí¬ì§€í† ë¦¬ëª…
          type: string
          description: GitHub í…œí”Œë¦¿ ë ˆí¬ì§€í† ë¦¬ëª…
          default: idp-aws-devenv-template
          pattern: '^[a-zA-Z0-9-_.]+$'
          ui:
            help: skeleton_sourceê°€ githubì¼ ë•Œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤
        github_template_branch:
          title: GitHub í…œí”Œë¦¿ ë¸Œëœì¹˜ëª…
          type: string
          default: main
          description: GitHub í…œí”Œë¦¿ ë¸Œëœì¹˜ëª…
          ui:
            help: skeleton_sourceê°€ githubì¼ ë•Œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤
        vpc_cidr:
          title: VPC CIDR ë¸”ë¡
          type: string
          default: "10.0.0.0/16"
          enum:
            - "10.0.0.0/16"
            - "10.1.0.0/16"
            - "10.2.0.0/16"
            - "172.16.0.0/16"
          description: VPCì˜ CIDR ë¸”ë¡ ì„ íƒ
        create_eks:
          title: ğŸš¢ EKS í´ëŸ¬ìŠ¤í„° ìƒì„±
          type: boolean
          default: true
          description: Kubernetes í´ëŸ¬ìŠ¤í„° (EKS) ìƒì„± ì—¬ë¶€
        create_rds:
          title: ğŸ—„ï¸ RDS ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
          type: boolean
          default: false
          description: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ (RDS) ìƒì„± ì—¬ë¶€

  steps:
    # 1. ì…ë ¥ê°’ ê²€ì¦ ë° ë¡œê¹…
    - id: validate-inputs
      name: ğŸ“‹ ì…ë ¥ê°’ ê²€ì¦
      action: debug:log
      input:
        message: |
          ğŸ” ì…ë ¥ê°’ ê²€ì¦ ì¤‘...
          
          ğŸ“‹ í”„ë¡œì íŠ¸ ì •ë³´:
          â”œâ”€â”€ íŒ€: ${{ parameters.team_name }}
          â”œâ”€â”€ í™˜ê²½: ${{ parameters.environment_type }}
          â”œâ”€â”€ í”„ë¡œì íŠ¸: ${{ parameters.project_name }}
          â””â”€â”€ ë¦¬ì „: ${{ parameters.aws_region }}
          
          ğŸ—ï¸ ì¸í”„ë¼ êµ¬ì„±:
          â”œâ”€â”€ VPC CIDR: ${{ parameters.vpc_cidr }}
          â”œâ”€â”€ EKS ìƒì„±: ${{ parameters.create_eks }}
          â”œâ”€â”€ RDS ìƒì„±: ${{ parameters.create_rds }}
          
          ğŸ“‚ GitHub:
          â”œâ”€â”€ Owner: ${{ parameters.github_owner }}
          â”œâ”€â”€ Repo: ${{ parameters.github_repo }}
          â””â”€â”€ Branch: ${{ parameters.github_branch }}
    # 2. í´ë¼ìš°ë“œ(AWS) ìŠ¤ì¼ˆë ˆí†¤ ë³µì‚¬ (ë¡œì»¬ íŒŒì¼)
    - id: fetch-aws-skeleton-local
      name: ğŸ—ï¸ AWS Terraform ìŠ¤ì¼ˆë ˆí†¤ ë³µì‚¬ (ë¡œì»¬)
      if: ${{ parameters.skeleton_source === 'local' }}
      action: fetch:template
      input:
        url: ./skeleton
        values:
          team_name: ${{ parameters.team_name }}
          environment_type: ${{ parameters.environment_type }}
          project_name: ${{ parameters.project_name }}
          aws_region: ${{ parameters.aws_region }}
          create_eks: ${{ parameters.create_eks | string }}
          create_rds: ${{ parameters.create_rds | string }}
          vpc_cidr: ${{ parameters.vpc_cidr }}
          github_owner: ${{ parameters.github_owner }}
          github_repo: ${{ parameters.github_repo }}
    
    # 2-1. í´ë¼ìš°ë“œ(AWS) ìŠ¤ì¼ˆë ˆí†¤ ë³µì‚¬ (GitHub í…œí”Œë¦¿)
    - id: fetch-aws-skeleton-github
      name: ğŸ—ï¸ AWS Terraform ìŠ¤ì¼ˆë ˆí†¤ ë³µì‚¬ (GitHub)
      if: ${{ parameters.skeleton_source === 'github' }}
      action: fetch:template
      input:
        url: https://github.com/${{ parameters.github_template_owner }}/${{ parameters.github_template_repo }}/tree/${{ parameters.github_template_branch }}/skeleton
        values:
          team_name: ${{ parameters.team_name }}
          environment_type: ${{ parameters.environment_type }}
          project_name: ${{ parameters.project_name }}
          aws_region: ${{ parameters.aws_region }}
          create_eks: ${{ parameters.create_eks | string }}
          create_rds: ${{ parameters.create_rds | string }}
          vpc_cidr: ${{ parameters.vpc_cidr }}
          github_owner: ${{ parameters.github_owner }}
          github_repo: ${{ parameters.github_repo }}
    # 3. íŒŒì¼ ìƒì„± ì™„ë£Œ
    - id: creation-summary
      name: âœ… íŒŒì¼ ìƒì„± ì™„ë£Œ
      action: debug:log
      input:
        message: |
          ğŸ“ ìƒì„±ëœ íŒŒì¼ë“¤:
          - terraform/main.tf
          - terraform/variables.tf  
          - terraform/outputs.tf
          - terraform/terraform.tfvars
          - .github/workflows/terraform.yml
          - terraform/README.md
          - terraform/catalog-info.yaml
          - .gitignore
    # template.yaml íŒŒì¼ ì œê±°
    - id: remove-template-yaml
      name: ğŸ—‘ï¸ Template.yaml ì œê±°
      action: fs:delete
      input:
        files:
          - template.yaml
    
    # 4. GitHubì— í‘¸ì‹œ
    - id: github-publish
      name: ğŸ“¤ GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„±
      action: publish:github
      input:
        repoUrl: github.com?owner=${{ parameters.github_owner }}&repo=${{ parameters.github_repo }}
        token: ${{ parameters.github_token }}
        defaultBranch: ${{ parameters.github_branch }}
        repoVisibility: private
        description: "ğŸ—ï¸ AWS Terraform Infrastructure for ${{ parameters.project_name }} - Environment: ${{ parameters.environment_type }}, Team: ${{ parameters.team_name }}, Region: ${{ parameters.aws_region }}"
        sourcePath: .
        # ì „ì²´ ë””ë ‰í† ë¦¬ push (template.yaml í¬í•¨)
        gitCommitMessage: |
          ğŸ‰ Initial AWS Terraform infrastructure setup

          Infrastructure for ${{ parameters.project_name }} (${{ parameters.environment_type }} environment)
          
          Components:
          - VPC with subnets (CIDR: ${{ parameters.vpc_cidr }})
          - EKS cluster (if enabled)
          - RDS PostgreSQL (if enabled)
          
          Team: ${{ parameters.team_name }}
          Region: ${{ parameters.aws_region }}
          
          âš ï¸ GitHub Actions Variables & SecretsëŠ” ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
      # ë ˆí¬ì§€í† ë¦¬ê°€ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì˜¤ë¥˜ ë¬´ì‹œí•˜ê³  ê³„ì† ì§„í–‰
      continueOnError: true
    
    # 5. GitHub í‘¸ì‹œ ê²°ê³¼ ë° ì„¤ì • í™•ì¸
    - id: github-result
      name: ğŸ“Š GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„± ë° ì„¤ì • ì™„ë£Œ
      action: debug:log
      input:
        message: |
          âœ… GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„± ë° ì„¤ì • ì™„ë£Œ!
          
          ğŸ“Š GitHub Publish ê²°ê³¼:
          - remoteUrl: ${{ steps.github-publish.output.remoteUrl }}
          - repoContentsUrl: ${{ steps.github-publish.output.repoContentsUrl }}
          - cloneUrl: ${{ steps.github-publish.output.cloneUrl }}
          
          âš™ï¸ ìˆ˜ë™ ì„¤ì •ì´ í•„ìš”í•œ GitHub Actions Variables:
          - AWS_REGION: ${{ parameters.aws_region }}
          - TEAM_NAME: ${{ parameters.team_name }}
          - ENVIRONMENT_TYPE: ${{ parameters.environment_type }}
          - PROJECT_NAME: ${{ parameters.project_name }}
          - VPC_CIDR: ${{ parameters.vpc_cidr }}
          - CREATE_EKS: ${{ parameters.create_eks | string }}
          - CREATE_RDS: ${{ parameters.create_rds | string }}
          
          ğŸ” ìˆ˜ë™ ì„¤ì •ì´ í•„ìš”í•œ GitHub Actions Secrets:
          - AWS_ACCESS_KEY_ID: ${{ parameters.aws_access_key_id | truncate(10) }}...
          - AWS_SECRET_ACCESS_KEY: ${{ parameters.aws_secret_access_key | truncate(10) }}...
          
          ğŸ—ï¸ êµ¬ì„±ëœ URL:
          - ì˜ˆìƒ URL: https://raw.githubusercontent.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/${{ parameters.github_branch }}/terraform/catalog-info.yaml
          - ì‹¤ì œ remoteUrl: ${{ steps.github-publish.output.remoteUrl }}
          
          ğŸ”§ ë‹¨ê³„ë³„ í™•ì¸:
          - github-publish ë‹¨ê³„ ID: github-publish
          - github-publish ë‹¨ê³„ ì¡´ì¬: ${{ steps.github-publish != null }}
          - github-publish ì¶œë ¥ ì¡´ì¬: ${{ steps.github-publish.output != null }}
          - UI ì…ë ¥ Github owner ê°’: ${{ parameters.github_owner }}
          - UI ì…ë ¥ Github repo ê°’: ${{ parameters.github_repo }}
          - UI ì…ë ¥ Github branch ê°’: ${{ parameters.github_branch }}
          - UI ì…ë ¥ Github token ê°’: ${{ parameters.github_token }}
    
    - id: setup-github-secrets
      name: ğŸ” GitHub Secrets ì„¤ì • ì•ˆë‚´
      action: debug:log
      input:
        message: |
          ğŸ” **GitHub Secrets ì„¤ì • ì•ˆë‚´**
          
          ğŸ“‹ **í•„ìš”í•œ Secrets:**
          - AWS_ACCESS_KEY_ID: ${{ parameters.aws_access_key_id | truncate(10) }}...
          - AWS_SECRET_ACCESS_KEY: ${{ parameters.aws_secret_access_key | truncate(10) }}...
          
          ğŸ”§ **ì„¤ì • ë°©ë²•:**
          1. GitHub ë ˆí¬ì§€í† ë¦¬ë¡œ ì´ë™: https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}
          2. Settings â†’ Secrets and variables â†’ Actions
          3. "New repository secret" í´ë¦­
          4. ìœ„ì˜ Secretsë“¤ì„ ì¶”ê°€
          
          âš ï¸ **ì£¼ì˜:** SecretsëŠ” ë³´ì•ˆìƒ ìë™ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
          ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”.

    # 5-1. ë³€ìˆ˜ ì¹˜í™˜ í…ŒìŠ¤íŠ¸
    - id: variable-test
      name: ğŸ” ë³€ìˆ˜ ì¹˜í™˜ í…ŒìŠ¤íŠ¸
      action: debug:log
      input:
        message: |
          ğŸ” ë³€ìˆ˜ ì¹˜í™˜ í…ŒìŠ¤íŠ¸:
          - owner: "${{ parameters.github_owner }}"
          - repo: "${{ parameters.github_repo }}"
          - branch: "${{ parameters.github_branch }}"
          - token ê¸¸ì´: ${{ parameters.github_token | length }}
          - token ì‹œì‘: "${{ parameters.github_token | truncate(10) }}"
    # GitHub í‘¸ì‹œ ê²°ê³¼ í™•ì¸
    - id: github-result-2
      name: ğŸ“Š GitHub í‘¸ì‹œ ê²°ê³¼ í™•ì¸
      action: debug:log
      input:
        message: |
          âœ… GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„± ì™„ë£Œ!
          - Repository: https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}
          - Branch: ${{ parameters.github_branch }}
          - Visibility: public

    # catalog-info.yaml íŒŒì¼ í™•ì¸
    - id: verify-catalog-file
      name: ğŸ” catalog-info.yaml íŒŒì¼ í™•ì¸
      action: debug:log
      input:
        message: |
          ğŸ” **catalog-info.yaml íŒŒì¼ í™•ì¸**:
          
          ğŸ“‚ **ì˜ˆìƒ íŒŒì¼ ê²½ë¡œ**:
          - GitHub: https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/blob/${{ parameters.github_branch }}/catalog-info.yaml
          - Raw: https://raw.githubusercontent.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/${{ parameters.github_branch }}/catalog-info.yaml
          
          ğŸ”§ **ìˆ˜ë™ í™•ì¸ ë°©ë²•**:
          ```bash
          # GitHub APIë¡œ íŒŒì¼ ì¡´ì¬ í™•ì¸
          curl -H "Authorization: token YOUR_TOKEN" \
               https://api.github.com/repos/${{ parameters.github_owner }}/${{ parameters.github_repo }}/contents/catalog-info.yaml
          
          # Raw íŒŒì¼ ì§ì ‘ í™•ì¸
          curl https://raw.githubusercontent.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/${{ parameters.github_branch }}/catalog-info.yaml
          ```
          
          âœ… **íŒŒì¼ì´ ì •ìƒì ìœ¼ë¡œ í‘¸ì‹œë˜ì—ˆë‹¤ë©´ ìœ„ URLë“¤ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.**
    
    # ì¹´íƒˆë¡œê·¸ ë“±ë¡ ë° GitHub Actions ì„¤ì • ì•ˆë‚´
    - id: catalog-registration-guide-2
      name: ğŸ“‹ ì¹´íƒˆë¡œê·¸ ë“±ë¡ ë° GitHub Actions ì„¤ì • ì•ˆë‚´
      action: debug:log
      input:
        message: |
          ğŸ‰ **GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„± ë° ì„¤ì • ì™„ë£Œ!**
          
          âš ï¸ **ìˆ˜ë™ ì„¤ì • í•„ìš”:**
          - GitHub Actions Variables: AWS_REGION, TEAM_NAME, ENVIRONMENT_TYPE, PROJECT_NAME, VPC_CIDR, CREATE_EKS, CREATE_RDS
          - GitHub Actions Secrets: AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY
          
          ğŸ“‚ **ì¹´íƒˆë¡œê·¸ ë“±ë¡ ë°©ë²•**:
          
          ğŸš€ **ì¦‰ì‹œ ë“±ë¡ (ê¶Œì¥)**:
          ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”:
          ```bash
          curl -X POST "http://localhost:7007/api/catalog/locations" \
            -H "Content-Type: application/json" \
            -d '{"type": "url", "target": "https://raw.githubusercontent.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/${{ parameters.github_branch }}/catalog-info.yaml"}'
          ```
          
          â° **ìë™ ë“±ë¡ (ë°±ì—…)**:
          GitHub Providerê°€ 1ë¶„ ë‚´ì— ìë™ìœ¼ë¡œ ìŠ¤ìº”í•©ë‹ˆë‹¤.
          - Backstage ì¹´íƒˆë¡œê·¸ í˜ì´ì§€ì—ì„œ 1-2ë¶„ í›„ ìƒˆë¡œê³ ì¹¨
          
          âš™ï¸ **GitHub Actions ìˆ˜ë™ ì„¤ì •:**
          1. GitHub ë ˆí¬ì§€í† ë¦¬ â†’ Settings â†’ Secrets and variables â†’ Actions
          2. Variables íƒ­: ë‹¤ìŒ ë³€ìˆ˜ë“¤ì„ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€:
             - AWS_REGION: ${{ parameters.aws_region }}
             - TEAM_NAME: ${{ parameters.team_name }}
             - ENVIRONMENT_TYPE: ${{ parameters.environment_type }}
             - PROJECT_NAME: ${{ parameters.project_name }}
             - VPC_CIDR: ${{ parameters.vpc_cidr }}
             - CREATE_EKS: ${{ parameters.create_eks | string }}
             - CREATE_RDS: ${{ parameters.create_rds | string }}
          3. Secrets íƒ­: ë‹¤ìŒ ì‹œí¬ë¦¿ë“¤ì„ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€:
             - AWS_ACCESS_KEY_ID: ${{ parameters.aws_access_key_id }}
             - AWS_SECRET_ACCESS_KEY: ${{ parameters.aws_secret_access_key }}
          4. Actions íƒ­: "Terraform CI/CD" ì›Œí¬í”Œë¡œìš° í™•ì¸
          
          ğŸš€ **ë‹¤ìŒ ë‹¨ê³„:**
          1. GitHub Actions â†’ "Terraform CI/CD" â†’ "Run workflow" â†’ Action: "plan"
          2. Plan ê²°ê³¼ í™•ì¸ í›„ ë¬¸ì œì—†ìœ¼ë©´ "apply" ì‹¤í–‰
          3. AWS ì½˜ì†”ì—ì„œ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ í™•ì¸
          
          ğŸ”— **ìƒì„±ëœ ë ˆí¬ì§€í† ë¦¬**:
          - GitHub: https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}
          - Raw URL: https://raw.githubusercontent.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/${{ parameters.github_branch }}/catalog-info.yaml
          
          âœ… **ë“±ë¡ í›„ í™•ì¸**:
          - ì¹´íƒˆë¡œê·¸ í˜ì´ì§€: http://localhost:3000/catalog
          - ì¹´íƒˆë¡œê·¸ ë“±ë¡ í˜ì´ì§€: http://localhost:3000/catalog-registration
          - ë˜ëŠ” ê²€ìƒ‰ì°½ì—ì„œ "${{ parameters.project_name }}" ê²€ìƒ‰
          
          ğŸ” **ë¬¸ì œ í•´ê²°:**
          - URLì´ 404 ì˜¤ë¥˜ì¸ ê²½ìš°: ë ˆí¬ì§€í† ë¦¬ ìƒì„± í›„ ëª‡ ë¶„ ëŒ€ê¸°
          - ì¸ì¦ ì˜¤ë¥˜ì¸ ê²½ìš°: GitHub í† í° ê¶Œí•œ í™•ì¸
          - ì´ë¯¸ ë“±ë¡ëœ ê²½ìš°: ê¸°ì¡´ ë“±ë¡ ì‚­ì œ í›„ ì¬ë“±ë¡
          - Variables/Secrets ë¯¸ì„¤ì •: GitHub ë ˆí¬ì§€í† ë¦¬ ì„¤ì •ì—ì„œ ìˆ˜ë™ ì„¤ì •

    # GitHub Actions ìˆ˜ë™ ì‹¤í–‰ ì•ˆë‚´
    - id: github-actions-manual-guide
      name: ğŸš€ GitHub Actions ìˆ˜ë™ ì‹¤í–‰ ì•ˆë‚´
      action: debug:log
      input:
        message: |
          ğŸ‰ **í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ!**
          
          ğŸ“‹ **GitHub Actions ìˆ˜ë™ ì‹¤í–‰ ë°©ë²•**:
          
          1. **GitHub ë ˆí¬ì§€í† ë¦¬ë¡œ ì´ë™**:
             https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}
          
          2. **Actions íƒ­ìœ¼ë¡œ ì´ë™**:
             https://github.com/${{ parameters.github_owner }}/${{ parameters.github_repo }}/actions
          
          3. **"Terraform CI/CD" ì›Œí¬í”Œë¡œìš° ì„ íƒ**
          
          4. **"Run workflow" ë²„íŠ¼ í´ë¦­**
          
          5. **Action ì„ íƒ**: "plan" (ê¸°ë³¸ê°’)
          
          6. **"Run workflow" í´ë¦­**
          
          âš™ï¸ **GitHub Actions Variables ì„¤ì •** (í•„ìš”ì‹œ):
          - AWS_REGION: ${{ parameters.aws_region }}
          - TEAM_NAME: ${{ parameters.team_name }}
          - ENVIRONMENT_TYPE: ${{ parameters.environment_type }}
          - PROJECT_NAME: ${{ parameters.project_name }}
          - VPC_CIDR: ${{ parameters.vpc_cidr }}
          - CREATE_EKS: ${{ parameters.create_eks | string }}
          - CREATE_RDS: ${{ parameters.create_rds | string }}
          
          ğŸ” **GitHub Actions Secrets ì„¤ì •** (í•„ìš”ì‹œ):
          - AWS_ACCESS_KEY_ID: ${{ parameters.aws_access_key_id | truncate(10) }}...
          - AWS_SECRET_ACCESS_KEY: ${{ parameters.aws_secret_access_key | truncate(10) }}...
          
          ğŸš€ **ìë™ íŠ¸ë¦¬ê±°**: ì½”ë“œ í‘¸ì‹œ ì‹œ ìë™ìœ¼ë¡œ Terraform Plan ì‹¤í–‰ë©ë‹ˆë‹¤.

  resources:
    - apiVersion: scaffolder.backstage.io/v1beta3
      kind: Resource
      metadata:
        name: terraform-infrastructure
        description: AWS Terraform ì¸í”„ë¼ ë¦¬ì†ŒìŠ¤